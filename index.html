<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Bella y la Bestia</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x.icon" href="favicon.ico">
</head>
<body>
    <div class="container">
        <form id="form" class="form">
            <h1>üåπMI NOCHE MAGICAüåπ</h1>
            <p >
                Hoy no solo florece una rosa... Tambi√©n florece Mi Alma.  
                Han pasado 15 a√±os desde que llegu√© al mundo, y en cada paso,  
                en cada risa y en cada l√°grima, fui creciendo, so√±ando y convirti√©ndome en quien soy.  
                Esta noche no es solo una fiesta, es el reflejo de mi coraz√≥n agradecido,  
                de cada abrazo que me sostuvo y de cada amor que me hizo brillar.  
                Con todo mi cari√±o, te invito a ser parte de Mi Noche M√°gica,  
                porque en mi cuento, t√∫ tambi√©n eres parte esencial.  
                <br>Con amor,<br>Treasy üåπ
            </p>

            <label for="nombre">NOMBRE DE INVITADO:</label>
            <input type="text" id="nombre" name="nombre" class="box" required>

            <label for="asistencia">¬øAsistir√©?</label>
            <select id="asistencia" name="asistencia" class="box" required>
                <option value="">SELECCIONA</option>
                <option value="S√≠">S√≠</option>
                <option value="No">No</option>
            </select>

            <div class="botones">
                <button class="box-1" type="button" onclick="verUbicacion()">üìç Ver Ubicaci√≥n</button>
                <button class="box-1" type="submit">‚úÖ Confirmar Asistencia</button>
            </div>

            <p id="respuesta"></p>
        </form>

        <div class="info">
            <img src="images/bella.png" class="img-1" alt="">
        </div>
    </div>

    <script>
        function verUbicacion() {
            window.open("https://www.google.com/maps/place/La+Fabrica+Boulevard/@-4.9163831,-80.6854248,17z/data=!4m6!3m5!1s0x9035f9006c08daf5:0x8ebcc01501c6500f!8m2!3d-4.9163884!4d-80.6828499!16s%2Fg%2F11vy7cxngv?entry=ttu&g_ep=EgoyMDI1MTAwMS4wIKXMDSoASAFQAw%3D%3D", "_blank");
        }

        // URL de SheetDB
        const url = "https://sheetdb.io/api/v1/iqfy7530557h2";

        document.getElementById('form').addEventListener('submit', async function(e) {
            e.preventDefault();

            // Validar fecha l√≠mite: 27 de octubre de 2025
            const fechaLimite = new Date('2025-10-27T23:59:59');
            const ahora = new Date();
            if (ahora > fechaLimite) {
                document.getElementById('respuesta').innerText = "‚ùå Lo sentimos, la fecha l√≠mite para enviar el formulario ha pasado.";
                return;
            }

            const nombre = document.getElementById('nombre').value.trim();
            const asistencia = document.getElementById('asistencia').value;

            if (!nombre || !asistencia) {
                document.getElementById('respuesta').innerText = "‚ùå Por favor, complete todos los campos.";
                return;
            }

            const datos = {
                data: {
                    Nombre: nombre,
                    Asistencia: asistencia,
                    Fecha: new Date().toLocaleString()
                }
            };

            try {
                const respuesta = await fetch(url, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(datos)
                });

                const resultado = await respuesta.json();

                if (resultado.created) {
                    document.getElementById('respuesta').innerText = "üåπ Gracias por formar parte de Mi Noche M√°gica üåπ";
                    document.getElementById('form').reset();
                } else {
                    document.getElementById('respuesta').innerText = "‚ùå Error al enviar datos.";
                }
            } catch (error) {
                console.error("Error al enviar los datos:", error);
                document.getElementById('respuesta').innerText = "‚ùå Fall√≥ la conexi√≥n con la hoja.";
            }
        });
    </script>
</body>
</html>
